# ç‰ˆæœ¬è™Ÿæ§åˆ¶æŒ‡å¼•

## ğŸ“Š ç‰ˆæœ¬è™Ÿæ§åˆ¶æ¦‚è¦½

æ‚¨çš„å°ˆæ¡ˆç¾åœ¨å·²ç¶“å»ºç«‹äº†å®Œæ•´çš„**ç‰ˆæœ¬è™Ÿæ§åˆ¶ç³»çµ±**ï¼

### ğŸ¯ ç•¶å‰ç‰ˆæœ¬ç‹€æ…‹
- **ç‰ˆæœ¬è™Ÿç®¡ç†**: âœ… å·²å»ºç«‹
- **Git æ¨™ç±¤**: âœ… è‡ªå‹•åŒ–
- **CI/CD æ•´åˆ**: âœ… å®Œæˆ
- **ç™¼ä½ˆæµç¨‹**: âœ… æ¨™æº–åŒ–

## ğŸ“‹ ç‰ˆæœ¬è™Ÿç³»çµ±æ¶æ§‹

### ğŸ”¢ Semantic Versioning (SemVer)

æˆ‘å€‘æ¡ç”¨ **Semantic Versioning** æ¨™æº–ï¼š

```
MAJOR.MINOR.PATCH.BUILD
  â†“     â†“     â†“     â†“
  1  .  0  .  0  . 12abc34
```

**ç‰ˆæœ¬é¡å‹èªªæ˜ï¼š**
- **MAJOR**: é‡å¤§åŠŸèƒ½è®Šæ›´æˆ–ä¸ç›¸å®¹çš„ API è®Šæ›´
- **MINOR**: æ–°å¢åŠŸèƒ½ï¼Œå‘å¾Œç›¸å®¹
- **PATCH**: éŒ¯èª¤ä¿®å¾©ï¼Œå‘å¾Œç›¸å®¹
- **BUILD**: CI/CD è‡ªå‹•ç”¢ç”Ÿçš„å»ºç½®ç·¨è™Ÿ

### ğŸ“ æ ¸å¿ƒæª”æ¡ˆ

```
Project Japan/
â”œâ”€â”€ ğŸ“„ version.py               # ç‰ˆæœ¬è™Ÿå®šç¾©æª”æ¡ˆ
â”œâ”€â”€ ğŸ“ scripts/
â”‚   â””â”€â”€ ğŸ“„ version_manager.py   # ç‰ˆæœ¬è™Ÿç®¡ç†å·¥å…·
â””â”€â”€ ğŸ“ deployment/
    â”œâ”€â”€ ğŸ“„ Dockerfile          # æ”¯æ´ç‰ˆæœ¬è™Ÿå»ºç½®
    â”œâ”€â”€ ğŸ“„ cloudbuild-production.yaml  # PRD ç‰ˆæœ¬åŒ–éƒ¨ç½²
    â””â”€â”€ ğŸ“„ cloudbuild-staging.yaml     # STG ç‰ˆæœ¬åŒ–éƒ¨ç½²
```

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### 1. æŸ¥çœ‹ç•¶å‰ç‰ˆæœ¬ç‹€æ…‹

```bash
python scripts/version_manager.py status
```

è¼¸å‡ºç¤ºä¾‹ï¼š
```
ğŸ“Š ç‰ˆæœ¬è™Ÿç‹€æ…‹
==================================================
ç•¶å‰ç‰ˆæœ¬: 1.0.0
ç•¶å‰åˆ†æ”¯: main
æœ€æ–°æ¨™ç±¤: ç„¡æ¨™ç±¤
å·¥ä½œç›®éŒ„: ä¹¾æ·¨
```

### 2. ç™¼ä½ˆæ–°ç‰ˆæœ¬

#### ğŸ“¦ Patch ç‰ˆæœ¬ (éŒ¯èª¤ä¿®å¾©)
```bash
python scripts/version_manager.py release patch "ä¿®å¾©è¨ˆç®—éŒ¯èª¤"
```

#### ğŸš€ Minor ç‰ˆæœ¬ (æ–°åŠŸèƒ½)
```bash
python scripts/version_manager.py release minor "æ–°å¢ç¨…å‹™è¨ˆç®—åŠŸèƒ½"
```

#### ğŸ’¥ Major ç‰ˆæœ¬ (é‡å¤§æ›´æ–°)
```bash
python scripts/version_manager.py release major "é‡æ§‹è¨ˆç®—å¼•æ“"
```

### 3. å®Œæ•´ç™¼ä½ˆæµç¨‹ç¤ºä¾‹

```bash
# 1. æŸ¥çœ‹ç•¶å‰ç‹€æ…‹
python scripts/version_manager.py status

# 2. ç™¼ä½ˆæ–°ç‰ˆæœ¬
python scripts/version_manager.py release minor "æ–°å¢ä»˜æ¬¾åŠŸèƒ½"
# ğŸš€ é–‹å§‹ç™¼ä½ˆæ–°ç‰ˆæœ¬ (minor)
# ==================================================
# ç‰ˆæœ¬æ›´æ–°: 1.0.0 â†’ 1.1.0
# âœ… æ›´æ–° version.py: 1.1.0
# âœ… æäº¤ç‰ˆæœ¬æ›´æ–°: 1.1.0
# âœ… å‰µå»º Git æ¨™ç±¤: v1.1.0
# âœ… ç‰ˆæœ¬ 1.1.0 æº–å‚™å®Œæˆ
# ğŸ”„ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¨é€åˆ°é ç«¯:
#    git push origin main
#    git push origin v1.1.0

# 3. æ¨é€åˆ°é ç«¯ (æœƒè§¸ç™¼è‡ªå‹•éƒ¨ç½²)
git push origin main
git push origin v1.1.0
```

## ğŸš€ CI/CD ç‰ˆæœ¬åŒ–éƒ¨ç½²

### è‡ªå‹•åŒ–æµç¨‹

ç•¶æ‚¨æ¨é€ç‰ˆæœ¬æ¨™ç±¤æ™‚ï¼ŒCI/CD æœƒè‡ªå‹•ï¼š

1. **è®€å–ç‰ˆæœ¬è™Ÿ**: å¾ `version.py` ç²å–ç‰ˆæœ¬
2. **ç”Ÿæˆå»ºç½®ç·¨è™Ÿ**: ä½¿ç”¨ Cloud Build ID
3. **å»ºç½® Docker æ˜ åƒ**: æ¨™è¨˜ç‚º `ç‰ˆæœ¬è™Ÿ.å»ºç½®ç·¨è™Ÿ`
4. **éƒ¨ç½²åˆ°ç’°å¢ƒ**: è¨­å®šç‰ˆæœ¬ç’°å¢ƒè®Šæ•¸
5. **æ¨™è¨˜æ˜ åƒ**: åŒæ™‚ä¿ç•™ `latest` å’Œç‰ˆæœ¬æ¨™ç±¤

### ç’°å¢ƒè®Šæ•¸è¨­å®š

éƒ¨ç½²å¾Œï¼Œæ‡‰ç”¨ç¨‹å¼æœƒæœ‰ä»¥ä¸‹ç’°å¢ƒè®Šæ•¸ï¼š
```bash
APP_VERSION=1.1.0          # ç‰ˆæœ¬è™Ÿ
BUILD_NUMBER=12abc34       # å»ºç½®ç·¨è™Ÿ
ENVIRONMENT=production     # ç’°å¢ƒæ¨™è­˜
```

### ç‰ˆæœ¬è³‡è¨Š API

æ‚¨å¯ä»¥é€šé API ç«¯é»æŸ¥çœ‹ç‰ˆæœ¬è³‡è¨Šï¼š
```bash
curl https://your-domain.com/version
```

å›æ‡‰ï¼š
```json
{
  "version": "1.1.0.12abc34",
  "version_info": [1, 1, 0],
  "app_name": "Japan Property Analyzer",
  "description": "æ—¥æœ¬ä¸å‹•ç”¢æŠ•è³‡èˆ‡å•†æ¥­æ¨¡å¼è²¡å‹™åˆ†æ",
  "author": "Benjamin Chang",
  "release_date": "2024-12-19",
  "build_number": "12abc34"
}
```

## ğŸ”„ èˆ‡ Git Flow çš„æ•´åˆ

### æ–°çš„é–‹ç™¼æµç¨‹

```mermaid
graph TD
    A[é–‹å§‹é–‹ç™¼] --> B[å‰µå»º Feature Branch]
    B --> C[é€²è¡Œé–‹ç™¼]
    C --> D[æäº¤è®Šæ›´åˆ° Feature Branch]
    D --> E[å‰µå»º Pull Request]
    E --> F[ä»£ç¢¼å¯©æŸ¥]
    F --> G[åˆä½µåˆ° Main]
    G --> H[ç™¼ä½ˆæ–°ç‰ˆæœ¬]
    H --> I[æ¨é€ç‰ˆæœ¬æ¨™ç±¤]
    I --> J[è‡ªå‹•è§¸ç™¼ç‰ˆæœ¬åŒ–éƒ¨ç½²]
    J --> K[éƒ¨ç½²å®Œæˆ]
```

### æ•´åˆå·¥ä½œæµç¨‹

```bash
# 1. æ­£å¸¸çš„ Git Flow é–‹ç™¼
git checkout -b feature/add-payment-feature
# ... é€²è¡Œé–‹ç™¼ ...
git add . && git commit -m "feat: æ–°å¢ä»˜æ¬¾åŠŸèƒ½" && git push origin feature/add-payment-feature
# ... å‰µå»ºä¸¦åˆä½µ PR ...

# 2. åˆä½µåˆ° main å¾Œï¼Œç™¼ä½ˆç‰ˆæœ¬
git checkout main
git pull origin main
python scripts/version_manager.py release minor "æ–°å¢ä»˜æ¬¾åŠŸèƒ½"

# 3. æ¨é€ç‰ˆæœ¬ (è§¸ç™¼éƒ¨ç½²)
git push origin main
git push origin v1.1.0
```

## ğŸ“Š ç‰ˆæœ¬è™Ÿç­–ç•¥å»ºè­°

### ä½•æ™‚ä½¿ç”¨å„ç¨®ç‰ˆæœ¬é¡å‹

#### ğŸ”§ PATCH (ä¿®å¾©)
- ä¿®å¾©è¨ˆç®—éŒ¯èª¤
- ä¿®å¾© UI å•é¡Œ
- æ•ˆèƒ½å„ªåŒ–
- å®‰å…¨æ€§ä¿®å¾©

```bash
python scripts/version_manager.py release patch "ä¿®å¾©åˆ©ç‡è¨ˆç®—ç²¾ç¢ºåº¦"
```

#### ğŸš€ MINOR (åŠŸèƒ½)
- æ–°å¢è¨ˆç®—æ¨¡å¼
- æ–°å¢ API ç«¯é»
- æ”¹é€²ä½¿ç”¨è€…ä»‹é¢
- æ–°å¢æ¸¬è©¦åŠŸèƒ½

```bash
python scripts/version_manager.py release minor "æ–°å¢å•†æ¥­ç§Ÿè³ƒè¨ˆç®—æ¨¡å¼"
```

#### ğŸ’¥ MAJOR (é‡å¤§è®Šæ›´)
- é‡æ§‹æ ¸å¿ƒæ¼”ç®—æ³•
- ä¸ç›¸å®¹çš„ API è®Šæ›´
- é‡å¤§æ¶æ§‹è®Šæ›´
- æŠ€è¡“æ£§å‡ç´š

```bash
python scripts/version_manager.py release major "é‡æ§‹ç‚ºå¾®æœå‹™æ¶æ§‹"
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. ç‰ˆæœ¬ç™¼ä½ˆå¤±æ•—
```bash
# æª¢æŸ¥ Git ç‹€æ…‹
python scripts/version_manager.py status

# ç¢ºä¿åœ¨ main åˆ†æ”¯ä¸”æ²’æœ‰æœªæäº¤è®Šæ›´
git checkout main
git pull origin main
git status
```

#### 2. æ¨™ç±¤æ¨é€å¤±æ•—
```bash
# æ‰‹å‹•æ¨é€ç‰¹å®šæ¨™ç±¤
python scripts/version_manager.py push 1.1.0
```

#### 3. ç‰ˆæœ¬è³‡è¨Šä¸æ­£ç¢º
```bash
# æŸ¥çœ‹ç‰ˆæœ¬æª”æ¡ˆ
python version.py

# æŸ¥çœ‹ API ç‰ˆæœ¬è³‡è¨Š
python -c "from version import get_version_info; print(get_version_info())"
```

## ğŸ“ˆ ç‰ˆæœ¬è™Ÿç™¼å±•ç¯„ä¾‹

```
v1.0.0 - åˆå§‹ç™¼ä½ˆ (åŸºæœ¬è¨ˆç®—åŠŸèƒ½)
â”œâ”€â”€ v1.0.1 - ä¿®å¾©è¨ˆç®—ç²¾ç¢ºåº¦
â”œâ”€â”€ v1.0.2 - ä¿®å¾© UI éŸ¿æ‡‰å•é¡Œ
â”œâ”€â”€ v1.1.0 - æ–°å¢ Airbnb æ¨¡å¼
â”œâ”€â”€ v1.1.1 - ä¿®å¾© GA è¿½è¹¤
â”œâ”€â”€ v1.2.0 - æ–°å¢æ³•äººè³¼è²·æ¨¡å¼
â”œâ”€â”€ v1.2.1 - å„ªåŒ–è¨ˆç®—æ•ˆèƒ½
â””â”€â”€ v2.0.0 - é‡æ§‹ç‚ºå¤šèªç³»æ”¯æ´
```

## ğŸ¯ æœ€ä½³å¯¦è¸

### 1. ç‰ˆæœ¬ç™¼ä½ˆæ™‚æ©Ÿ
- **æ¯å€‹ Sprint/é€±æœŸçµæŸ**æ™‚ç™¼ä½ˆ Minor ç‰ˆæœ¬
- **ç·Šæ€¥ä¿®å¾©**æ™‚ç™¼ä½ˆ Patch ç‰ˆæœ¬
- **é‡å¤§é‡Œç¨‹ç¢‘**æ™‚ç™¼ä½ˆ Major ç‰ˆæœ¬

### 2. ç‰ˆæœ¬è¨Šæ¯æ’°å¯«
```bash
# å¥½çš„ç‰ˆæœ¬è¨Šæ¯
python scripts/version_manager.py release minor "æ–°å¢å¤šå¹£åˆ¥æ”¯æ´åŠŸèƒ½"

# é¿å…çš„ç‰ˆæœ¬è¨Šæ¯
python scripts/version_manager.py release minor "æ›´æ–°"
```

### 3. ç™¼ä½ˆå‰æª¢æŸ¥æ¸…å–®
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] åŠŸèƒ½å®Œæ•´æ¸¬è©¦
- [ ] æ–‡æª”å·²æ›´æ–°
- [ ] æ²’æœ‰æœªæäº¤çš„è®Šæ›´
- [ ] åœ¨ main åˆ†æ”¯ä¸Š

---

**ğŸ‰ æ­å–œï¼æ‚¨ç¾åœ¨æ“æœ‰å®Œæ•´çš„ä¼æ¥­ç´šç‰ˆæœ¬è™Ÿæ§åˆ¶ç³»çµ±ï¼**

é€™å€‹ç³»çµ±è®“æ‚¨çš„å°ˆæ¡ˆå…·å‚™ï¼š
- ğŸ”¢ **æ¨™æº–åŒ–ç‰ˆæœ¬ç®¡ç†**
- ğŸš€ **è‡ªå‹•åŒ–éƒ¨ç½²**
- ğŸ“Š **ç‰ˆæœ¬è¿½æº¯èƒ½åŠ›**
- ğŸ›¡ï¸ **å“è³ªæ§åˆ¶æµç¨‹** 