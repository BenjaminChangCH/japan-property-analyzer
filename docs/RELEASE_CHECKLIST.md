# 發佈檢查清單

## 📋 發佈前必須檢查清單

在每次發佈新版本前，請確保完成以下所有檢查項目：

### 🔍 程式碼品質檢查
- [ ] 執行程式碼品質掃描：`python scripts/quality_checker.py all`
- [ ] 品質評分 ≥ 80 分
- [ ] 沒有高危安全漏洞
- [ ] 沒有敏感資訊洩漏
- [ ] 代碼風格符合標準

### 🧪 測試檢查
- [ ] STG API 測試通過：`python tests/stg/test_stg_api.py`
- [ ] STG GA 測試通過：`python tests/stg/test_stg_ga.py`
- [ ] STG 瀏覽器測試通過：`python tests/stg/test_stg_browser.py`
- [ ] PRD API 測試通過：`python tests/prd/test_prd_api.py`
- [ ] PRD GA 測試通過：`python tests/prd/test_prd_ga.py`

### 🏥 健康檢查
- [ ] STG 健康檢查通過：`curl https://stg-domain/health/detailed`
- [ ] PRD 健康檢查通過：`curl https://prd-domain/health/detailed`
- [ ] 系統資源使用正常 (CPU < 80%, Memory < 90%)
- [ ] 錯誤率 < 5%

### 🔒 安全性檢查
- [ ] 依賴安全掃描通過
- [ ] HTTPS 證書有效
- [ ] 安全標頭設定正確
- [ ] 請求頻率限制生效
- [ ] CORS 設定正確

### 📊 監控和日誌
- [ ] 日誌系統正常運作
- [ ] 錯誤監控已啟用
- [ ] GA 追蹤正常工作
- [ ] 健康檢查端點可訪問

### 💾 備份檢查
- [ ] 創建發佈前備份：`python scripts/backup_manager.py backup`
- [ ] 驗證備份檔案完整性
- [ ] 確認回滾計畫可執行

### 📝 文檔檢查
- [ ] 版本號更新正確
- [ ] CHANGELOG.md 已更新
- [ ] API 文檔與實際功能一致
- [ ] 部署文檔是最新的

### 🌐 環境檢查
- [ ] 環境變數設定正確
- [ ] 配置檔案無誤
- [ ] CI/CD 流水線正常
- [ ] 容器映像建置成功

### 🚀 部署準備
- [ ] Git 工作目錄乾淨
- [ ] 在 main 分支上
- [ ] 所有 PR 已合併
- [ ] 版本標籤已創建

---

## 🚨 緊急發佈檢查清單

如果是緊急修復發佈，可以跳過以下非關鍵項目：
- 程式碼風格檢查（保留安全檢查）
- 完整的瀏覽器測試
- 文檔更新

但以下項目**必須**檢查：
- [ ] 安全漏洞掃描
- [ ] 核心功能測試
- [ ] 備份創建
- [ ] 健康檢查

---

## 📋 發佈後驗證清單

### 即時驗證 (發佈後 5 分鐘內)
- [ ] 應用程式啟動成功
- [ ] 健康檢查端點正常：`/health`
- [ ] 版本資訊正確：`/version`
- [ ] 主要功能可用

### 短期驗證 (發佈後 30 分鐘內)
- [ ] 沒有錯誤警報
- [ ] GA 追蹤資料正常
- [ ] 用戶反饋正常
- [ ] 系統效能正常

### 長期監控 (發佈後 24 小時內)
- [ ] 錯誤率沒有顯著增加
- [ ] 效能指標穩定
- [ ] 用戶行為分析正常

---

## 🔄 回滾條件

如果發現以下任何問題，應立即執行回滾：

### 🚨 立即回滾
- 應用程式無法啟動
- 核心功能完全失效
- 安全漏洞被利用
- 資料遺失或損壞

### ⚠️ 考慮回滾
- 錯誤率 > 10%
- 效能下降 > 50%
- 用戶投訴大量增加
- 監控系統異常

### 📞 回滾程序
1. 評估影響範圍
2. 執行備份驗證
3. 使用版本管理工具回滾：`python scripts/version_manager.py rollback`
4. 驗證回滾成功
5. 通知相關人員
6. 分析問題原因

---

## 🎯 發佈最佳實踐

### 發佈時機
- **推薦**：工作日上午 (避免週五下午)
- **避免**：假期前、深夜、週末

### 溝通計畫
- 提前通知相關人員
- 準備發佈說明
- 設定監控警報
- 準備回滾計畫

### 風險控制
- 分階段發佈 (STG → PRD)
- 功能開關控制
- 監控指標設定
- 自動回滾機制

---

**記住：品質比速度更重要！** 

寧可多花 10 分鐘檢查，也不要因為急於發佈而造成生產問題。 